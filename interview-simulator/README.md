# ğŸ™ï¸ IntervIA â€” AI Interview Simulator with 3D Avatar

> Practice job interviews with an AI-powered 3D interviewer. Get real-time voice interaction, facial expressions, and instant feedback.

![Angular](https://img.shields.io/badge/Angular-21-DD0031?logo=angular)
![NestJS](https://img.shields.io/badge/NestJS-11-E0234E?logo=nestjs)
![TypeScript](https://img.shields.io/badge/TypeScript-5.9-3178C6?logo=typescript)
![License](https://img.shields.io/badge/License-MIT-green)

---

## âœ¨ Features

- **3D Talking Avatar** â€” Realistic interviewer with lip-sync, facial expressions, and animations powered by [TalkingHead](https://github.com/met4citizen/TalkingHead)
- **AI-Powered Questions** â€” Dynamic interview questions generated by Arcee AI Trinity via [OpenRouter](https://openrouter.ai/)
- **Voice Interaction** â€” Speech-to-text input and text-to-speech output using Web Speech API + Google Cloud TTS
- **Multiple Interview Types** â€” Technical, Behavioral, and Mixed interviews at Junior/Mid/Senior levels
- **Real-Time Evaluation** â€” AI-generated post-interview report with scores, strengths, and improvement areas
- **Interview History** â€” Track past interviews with scores and detailed reports
- **Resume Parsing** â€” Upload PDF resume for personalized interview questions
- **Dark/Light Theme** â€” Tailwind CSS-based theming with system preference detection
- **Bilingual** â€” Full English and Spanish support (i18n with ngx-translate)
- **Responsive Design** â€” Works on desktop, tablet, and mobile
- **Accessible** â€” WCAG 2.1 AA compliant with ARIA labels and keyboard navigation

---

## ğŸ—ï¸ Architecture

```
IntervIA/
â”œâ”€â”€ render.yaml            # Render.com Blueprint (deployment config)
â””â”€â”€ interview-simulator/
    â”œâ”€â”€ frontend/          # Angular 21 SPA
    â”‚   â”œâ”€â”€ src/app/
    â”‚   â”‚   â”œâ”€â”€ core/      # Services (avatar, voice, state, storage, toast, connection)
    â”‚   â”‚   â”œâ”€â”€ features/  # Pages (home, interview, report, history)
    â”‚   â”‚   â””â”€â”€ shared/    # Components (navbar, theme-toggle, toast-container)
    â”‚   â””â”€â”€ cypress/       # E2E tests
    â”œâ”€â”€ backend/           # NestJS 11 API
    â”‚   â””â”€â”€ src/
    â”‚       â”œâ”€â”€ interview/ # Controller, service, DTOs, session management
    â”‚       â”œâ”€â”€ openrouter/ # AI model integration (Arcee Trinity)
    â”‚       â”œâ”€â”€ tts/       # Google Cloud Text-to-Speech with lipsync
    â”‚       â””â”€â”€ health/    # Health check endpoint
    â”œâ”€â”€ infra/
    â”‚   â””â”€â”€ docker/        # Dockerfile for backend
    â””â”€â”€ .github/
        â”œâ”€â”€ workflows/     # CI pipeline
        â”œâ”€â”€ specs/         # Project specification & tasks
        â””â”€â”€ dependabot.yml # Automated dependency updates
```

---

## ğŸš€ Quick Start

### Prerequisites

- **Node.js** â‰¥ 22
- **npm** â‰¥ 10
- [OpenRouter API key](https://openrouter.ai/keys) (for AI model)

### 1. Clone the repository

```bash
git clone https://github.com/juanmopy/IntervIA.git
cd IntervIA/interview-simulator
```

### 2. Set up the backend

```bash
cd backend
cp .env.example .env
# Edit .env with your API keys
npm install
npm run start:dev
```

The API will be available at `http://localhost:3000/api`.

### 3. Set up the frontend

```bash
cd frontend
npm install
npm start
```

The app will be available at `http://localhost:4200`.

### 4. Run tests

```bash
# Backend tests (Jest)
cd backend && npm test

# Frontend unit tests (Vitest)
cd frontend && npm test

# Frontend E2E tests (Cypress)
cd frontend && npm run cypress:run
```

---

## ğŸ”§ Environment Variables

### Backend (`backend/.env`)

| Variable | Description | Required |
|----------|-------------|----------|
| `OPENROUTER_API_KEY` | API key for OpenRouter (Arcee Trinity model) | âœ… |
| `OPENROUTER_MODEL` | AI model identifier (default: `arcee-ai/trinity-large-preview:free`) | No |
| `PORT` | Server port (default: 3000) | No |
| `CORS_ORIGIN` | Allowed CORS origin (default: `http://localhost:4200`) | No |
| `THROTTLE_TTL` | Rate limit window in ms (default: 60000) | No |
| `THROTTLE_LIMIT` | Max requests per window (default: 30) | No |

---

## ğŸ“¡ API Documentation

### Base URL: `/api`

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/health` | Health check |
| `POST` | `/interview/start` | Start a new interview session |
| `POST` | `/interview/message` | Send user message, receive AI response |
| `POST` | `/interview/end` | End interview, receive evaluation report |
| `GET` | `/interview/:id` | Get session state |
| `POST` | `/interview/parse-resume` | Upload PDF resume for text extraction |

### POST `/api/interview/start`

```json
{
  "role": "Frontend Developer",
  "type": "technical",
  "difficulty": "mid",
  "language": "en",
  "totalQuestions": 8,
  "resumeText": "Optional resume text...",
  "jobDescription": "Optional job description..."
}
```

**Response:**
```json
{
  "sessionId": "uuid",
  "message": {
    "messages": [{ "text": "...", "facialExpression": "smile", "animation": "Talking", "emotion": "friendly" }],
    "metadata": { "questionNumber": 1, "totalQuestions": 8, "phase": "introduction", "scoreHint": null }
  },
  "audio": "base64...",
  "lipsync": { "mouthCues": [...] }
}
```

### POST `/api/interview/end`

**Response:**
```json
{
  "report": {
    "overallScore": 78,
    "strengths": ["Strong technical knowledge", "Clear communication"],
    "improvements": ["Could provide more examples"],
    "questionScores": [
      { "question": "...", "answer": "...", "score": 8, "feedback": "..." }
    ],
    "suggestedResources": ["System Design Primer"]
  }
}
```

---

## ğŸš¢ Deployment

The project deploys to **[Render.com](https://render.com/)** using a Blueprint (`render.yaml` at the repo root).

### Render.com (recommended)

1. Go to [render.com](https://render.com/) â†’ **New** â†’ **Blueprint**
2. Select the `juanmopy/IntervIA` repository
3. Render will detect `render.yaml` and configure two services:
   - **intervia-api** â€” NestJS backend (free web service)
   - **intervia-web** â€” Angular frontend (static site)
4. Set the `OPENROUTER_API_KEY` secret when prompted
5. Click **Apply** â€” both services will build and deploy automatically

| Service | URL |
|---------|-----|
| Frontend | `https://intervia-web.onrender.com` |
| Backend API | `https://intervia-api.onrender.com/api` |

> **Note:** On the free tier, services sleep after 15 min of inactivity. The first request may take ~30s to wake up.

### Docker (alternative)

```bash
docker build -f infra/docker/Dockerfile.backend -t interview-api .
docker run -p 3000:3000 --env-file backend/.env interview-api
```

---

## ğŸ§ª Testing

| Layer | Framework | Command | Coverage |
|-------|-----------|---------|----------|
| Backend unit | Jest | `cd backend && npm test` | 43+ tests, 6 suites |
| Frontend unit | Vitest | `cd frontend && npm test` | 109+ tests, 14 files |
| Frontend E2E | Cypress | `cd frontend && npm run e2e` | 3 spec files |

---

## ğŸŒ Internationalization

The app supports English and Spanish. Translation files are in `frontend/src/assets/i18n/`.

To add a new language:
1. Create `frontend/src/assets/i18n/{lang}.json`
2. Add the language option to the navbar selector in `navbar.component.ts`
3. Add the language to the interview config form

---

## ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/my-feature`
3. Commit your changes: `git commit -m 'Add my feature'`
4. Push to the branch: `git push origin feature/my-feature`
5. Open a Pull Request

Please ensure:
- All tests pass (`npm test` in both frontend and backend)
- Code follows the existing style conventions
- New features include appropriate tests

---

## ğŸ“„ License

This project is licensed under the MIT License. See [LICENSE](LICENSE) for details.
